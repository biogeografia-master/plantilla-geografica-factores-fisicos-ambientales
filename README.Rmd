---
title: "Biogeografía"
subtitle: "Unidad 2. La “plantilla” geográfica: factores físicos y ambientales"
author: "José-Ramón Martínez-Batlle"
institute: "Universidad Autónoma de Santo Domingo (UASD)"
date: "Actualizado: `r Sys.Date()`"
output:
  xaringan::moon_reader:
    lib_dir: libs
    mathjax: "default"
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo=FALSE,
  warning=FALSE,
  message=FALSE,
  cache=TRUE,
  fig.align="center",
  fig.width=8,
  fig.height=5)
# Paquetes
pkgs <- c("ggplot2","dplyr","tidyr","purrr","scales","grid","maps","mapproj")
invisible(lapply(pkgs, function(p) if (!requireNamespace(p, quietly=TRUE)) try(suppressWarnings(install.packages(p)), silent=TRUE)))
lapply(pkgs, library, character.only=TRUE)
```

<style>
.title-slide {
  background-image: url('img/fondo.jpg');
  background-size: cover;
  background-position: center;
}
.remark-slide-content {
  font-size: 24px;
  line-height: 1.4;
  <!-- font-family: "Inter", "Helvetica Neue", Arial, sans-serif; -->
}
.large { font-size: 130% }
.medium { font-size: 110% }
.small { font-size: 90% }
.tiny { font-size: 70% }
.green { color: #2E8B57; }
.blue { color: #4169E1; }
.red { color: #DC143C; }
.yellow { color: #FFD700; }
.highlight { background-color: #ffff99; padding: 2px 4px; }
.box {
  background-color: #f0f8ff; border: 2px solid #4169E1; border-radius: 10px; padding: 20px; margin: 10px 0;
}
.box-small-margin {
  background-color: #f0f8ff; border: 2px solid #4169E1; border-radius: 10px; padding: 20px; margin: 2px 0;
}
.centered { text-align: center; }
blockquote { border-left: 4px solid #4169E1; padding-left: 12px; color: #333; }
</style>


---

class: inverse, center, middle

# Unidad 2
## La “plantilla” geográfica: factores físicos y ambientales

---

# Índice

1. **Introducción**: definiciones, elementos comunes, importancia, nociones básicas de cartografía
2. **Clima**: balance energético, radiación, fundamentos astronómicos, temperatura, circulación, humedad/precipitación, biomas y variación
3. **Ambiente acuático**: agua en la Tierra, luz con la profundidad, propiedades físico-químicas, ambientes de agua dulce
4. **Ambiente terrestre**: constricciones físicas, luz, suelo
5. **Prácticas reproducibles** en R (gráficos/tablas)


---

# Introducción

.box[
**La “plantilla geográfica”**: marco físico-ambiental que condiciona la distribución de organismos y comunidades en el espacio y el tiempo.
]

.small[
- Variables clave: **clima**, **relieve**, **suelo**, **hidrología**, **ambiente acuático**.
- Escalas: global → regional → local → microambiente.
- Relevancia biogeográfica: límites de nicho, **gradientes latitudinales y altitudinales**, barreras y corredores, zonas de transición.
]


---

# Nociones básicas de cartografía

.pull-left[
- Coordenadas geográficas (lat, lon)
- Proyecciones: **área** vs **forma** (compromisos)
- Distorsiones crecen con la latitud
- Escala y generalización
]

.pull-right[
```{r world-proj-merc}
world <- maps::map("world", fill=TRUE, plot=FALSE)
par(mar=c(0,0,0,0))
map("world", col="grey80", fill=TRUE, bg="white")
title("Proyección Mercator (conserva forma)")
```
]

---

# Nociones básicas de cartografía (II)

.pull-left[
```{r world-proj-equalarea}
par(mar=c(0,0,0,0))
map("world", proj="azequalarea", orient=c(0,0,0), col="grey80", fill=TRUE)
title("Azimuthal Equal-Area (conserva área)")
```
]

.pull-right[
.small[
**Idea clave**: la visualización **condiciona la interpretación**. Para patrones globales (p. ej., biomas), usar proyecciones de **igual área** evita sesgos por latitud.
]
]


---

# Clima · Balance energético simplificado

.small[
De ~100 unidades que llegan al tope de la atmósfera, ~**51** alcanzan la superficie; de estas, una parte se **emite** de vuelta (calor sensible/latente) y otra se **absorbe**.
]

```{r balance-energetico}
bal <- data.frame(
  componente=c("A superficie","Evaporación (latente)","Calentamiento del aire","Absorbida por superficie"),
  unidades=c(51,23,7,21)
)

bal$componente <- factor(bal$componente, levels=rev(bal$componente))

ggplot(bal, aes(x=unidades, y=componente))+
  geom_col()+
  geom_text(aes(label=unidades), hjust=-0.1)+
  scale_x_continuous(expand=expansion(mult=c(0,0.1)))+
  labs(x="Unidades (relativas)", y=NULL, title="Partición simplificada de la energía solar a escala global")+
  theme_minimal(base_size=14)
```

.tiny[Valores aproximados usados tradicionalmente para docencia.] 


---

# Clima · Radiación electromagnética

.small[
**Objetos calientes** emiten longitudes de onda cortas (pico solar ~0.5 μm). **Objetos fríos** (Tierra) emiten onda larga (pico ~10 μm).
]

```{r planck}
planck <- function(lambda_um, T){
  # Ley de Planck (radiancia espectral relativa)
  lambda <- lambda_um*1e-6
  h <- 6.62607015e-34; c <- 2.99792458e8; k <- 1.380649e-23
  (2*h*c^2)/(lambda^5) * 1/(exp((h*c)/(lambda*k*T))-1)
}

lam <- seq(0.2, 30, length.out=800)
sol <- planck(lam, 5778)
tierra <- planck(lam, 288)

library(tidyr)
df <- tibble(lambda=lam, `Sol (5778K)`=sol/max(sol), `Tierra (288K)`=tierra/max(tierra)) |>
  pivot_longer(-lambda, names_to="cuerpo", values_to="rel")

ggplot(df, aes(lambda, rel, linetype=cuerpo))+
  geom_line(size=1)+
  scale_x_log10(labels=scales::label_number(accuracy=0.1))+
  labs(x="Longitud de onda (μm, escala log)", y="Radiancia relativa",
       title="Espectros ideales de emisión (ley de Planck)")+
  theme_minimal(base_size=14)
```


---

# Clima · Fundamentos astronómicos

.small[
La inclinación del eje terrestre (~23.5°) genera **estaciones**. La duración del día varía con latitud y fecha.
]

```{r daylength}
# Duración del día (horas) en solsticio para distintas latitudes
lat <- seq(-80, 80, by=1)
deg2rad <- function(d) d*pi/180
rad2deg <- function(r) r*180/pi
# Aproximación: declinaciones ±23.44°
H <- function(phi, delta){ acos(pmin(pmax(-tan(deg2rad(phi))*tan(deg2rad(delta)),-1),1)) }
DL <- function(phi, delta){ 24/pi * H(phi, delta) }
DL_jun <- DL(lat, 23.44)
DL_dic <- DL(lat, -23.44)

d <- tibble(lat, `Junio (solsticio)`=DL_jun, `Diciembre (solsticio)`=DL_dic) |>
  pivot_longer(-lat, names_to="fecha", values_to="horas")

ggplot(d, aes(lat, horas, color=fecha))+
  geom_line(size=1)+
  labs(x="Latitud (°)", y="Horas de luz", title="Duración del día en solsticios por latitud")+
  theme_minimal(base_size=14)
```


---

# Clima · Temperatura con la altitud

```{r lapse}
alt <- seq(0, 10, by=0.1)
T0 <- 20
adiab <- tibble(
  alt_km = rep(alt,2),
  T = c(T0 - 10*alt, T0 - 6*alt),
  tipo = rep(c("Gradiente adiabático seco (~10 °C/km)", "Gradiente adiabático húmedo (~6 °C/km)"), each=length(alt))
)

ggplot(adiab, aes(T, alt_km, linetype=tipo))+
  geom_line(size=1)+
  scale_y_reverse()+
  labs(x="Temperatura (°C)", y="Altitud (km)", title="Disminución idealizada de T con la altitud")+
  theme_minimal(base_size=14)
```


---

# Clima · Circulación general (esquema)

```{r cells, fig.height=4.5}
par(mar=c(1,1,1,1))
plot(NA, xlim=c(-90,90), ylim=c(0,1), axes=FALSE, xlab="Latitud", ylab="", xaxs="i", yaxs="i")
axis(1, at=seq(-90,90,30))
rect(-90,0, -60,1, col=rgb(0.9,0.95,1,0.6), border=NA)
rect(-60,0, -30,1, col=rgb(0.8,0.9,1,0.6), border=NA)
rect(-30,0,   0,1, col=rgb(0.9,0.95,1,0.6), border=NA)
rect(  0,0,  30,1, col=rgb(0.9,0.95,1,0.6), border=NA)
rect( 30,0,  60,1, col=rgb(0.8,0.9,1,0.6), border=NA)
rect( 60,0,  90,1, col=rgb(0.9,0.95,1,0.6), border=NA)
# Flechas de vientos superficiales dominantes
arrows(-60,0.2,-30,0.2, length=0.08)
arrows(-30,0.2,-60,0.2, length=0.08)
arrows( 30,0.2, 60,0.2, length=0.08)
arrows( 60,0.2, 30,0.2, length=0.08)
arrows(-30,0.8,  0,0.8, length=0.08)
arrows(  0,0.8,-30,0.8, length=0.08)
arrows(  0,0.2, 30,0.2, length=0.08)
arrows( 30,0.2,  0,0.2, length=0.08)
text(c(-75,-45,-15,15,45,75), 0.95, c("Célula Polar","Célula Ferrel","Célula Hadley","Célula Hadley","Célula Ferrel","Célula Polar"))
text(0, -0.02, "Latitud (°)")
```

.tiny[Esquema ilustrativo de células de circulación (Hadley–Ferrel–Polar) y vientos dominantes.]


---

# Clima · Humedad: presión de vapor a saturación

```{r clausius}
# Aproximación Tetens para e_s (kPa)
es <- function(T){ 0.6108 * exp((17.27*T)/(T+237.3)) }
T <- seq(-20, 40, by=0.5)

ggplot(data.frame(T, es=es(T)), aes(T, es))+
  geom_line(size=1)+
  labs(x="Temperatura (°C)", y=expression(paste("e"[s]," (kPa)")), title="Capacidad del aire para vapor de agua (saturación)")+
  theme_minimal(base_size=14)
```


---

# Clima · Precipitación latitudinal idealizada

```{r precip}
lat <- seq(-60,60, by=1)
# Pico ecuatorial (ZCIT) y cinturones subtropicales secos
P <- 200 * exp(-(lat/15)^2) + 20 * exp(-((lat-50)/10)^2) + 20 * exp(-((lat+50)/10)^2)

ggplot(data.frame(lat,P), aes(lat,P))+
  geom_area(alpha=0.6)+
  labs(x="Latitud (°)", y="mm/mes (idealizado)", title="Perfil latitudinal idealizado de precipitación")+
  theme_minimal(base_size=14)
```


---

# Clima · Biomas según clima (esquema de Whittaker)

```{r whittaker}
# Rectángulos aproximados de biomas en el plano MAT vs MAP
biomas <- tibble::tribble(
  ~x, ~y, ~w, ~h, ~etq,
   -10, 100, 20, 200, "Tundra",
     0, 200, 25, 300, "Taiga/Boreal",
    10, 400, 30, 600, "Bosque templado",
    20, 200, 30, 200, "Praderas templadas",
    25, 100, 30, 200, "Desierto",
    25, 800, 30, 1400, "Selva tropical"
)

p <- ggplot()+
  geom_rect(data=biomas, aes(xmin=x, ymin=y, xmax=x+w, ymax=y+h), fill="grey90", color="grey40")+
  geom_text(data=biomas, aes(x=x+w/2, y=y+h/2, label=etq), size=4)+
  labs(x="Temperatura media anual (°C)", y="Precipitación anual (mm)", title="Esquema conceptual de biomas (Whittaker)")+
  theme_minimal(base_size=14)

# Puntos de ciudades (ejemplo reproducible)
ciudades <- tibble::tribble(
  ~ciudad, ~MAT, ~MAP,
  "Santo Domingo", 27.2, 1400,
  "Madrid", 15.0, 436,
  "Lima", 19.0, 16,
  "Ciudad de México", 17.5, 820,
  "Reykjavík", 4.5, 800,
  "Nairobi", 18.0, 900
)

p + geom_point(data=ciudades, aes(MAT, MAP), size=3) + ggrepel::geom_text_repel(data=ciudades, aes(MAT, MAP, label=ciudad), size=3)
```

---

# Ambiente acuático · ¿Dónde está el agua?

```{r agua}
comp <- tibble::tribble(
  ~componente, ~porc,
  "Océanos", 96.5,
  "Hielos y glaciares", 1.74,
  "Aguas subterráneas", 1.69,
  "Lagos/ríos/humedales", 0.013,
  "Atmósfera", 0.001
)

comp$componente <- factor(comp$componente, levels=comp$componente)

ggplot(comp, aes(porc, componente))+
  geom_col() +
  geom_text(aes(label=scales::percent(porc/100)), hjust=-0.1) +
  scale_x_continuous(expand=expansion(mult=c(0,0.2)))+
  labs(x="Porcentaje del agua de la Tierra", y=NULL, title="Distribución global del agua (aprox.)")+
  theme_minimal(base_size=14)
```

.tiny[Valores redondeados para docencia.] 


---

# Ambiente acuático · Luz vs profundidad (Beer-Lambert)

```{r beer}
z <- seq(0, 60, by=0.5)
I0 <- 100
ks <- c(0.05, 0.15, 0.5) # aguas claras → turbias
curvas <- purrr::map_dfr(ks, ~tibble(z=z, I=I0*exp(-.x*z), k=.x))

curvas$k <- factor(curvas$k, labels=c("k=0.05 (clara)","k=0.15 (meso)","k=0.5 (turbia)"))

ggplot(curvas, aes(I, z, color=k))+
  geom_line(size=1)+
  scale_y_reverse()+
  labs(x="I(z) (relativa)", y="Profundidad (m)", title="Atenuación de la luz con la profundidad")+
  theme_minimal(base_size=14)
```


---

# Ambiente acuático · Termoclina idealizada

```{r termo}
z <- seq(0, 40, by=0.1)
T <- 25 - 15/(1+exp(-(z-15)/2))

ggplot(data.frame(z,T), aes(T,z))+
  geom_line(size=1)+
  scale_y_reverse()+
  labs(x="Temperatura (°C)", y="Profundidad (m)", title="Perfil de temperatura en lago estratificado (verano)")+
  theme_minimal(base_size=14)
```


---

# Ambiente acuático · O₂ en función de T (solubilidad)

```{r o2}
T <- seq(0, 35, by=0.5)
# Aproximación lineal simple para docencia (mg/L)
O2 <- 14.6 - 0.4*T + 0.005*T^2

ggplot(data.frame(T,O2), aes(T,O2))+
  geom_line(size=1)+
  labs(x="Temperatura (°C)", y="Solubilidad de O₂ (mg/L)", title="Disminución de la solubilidad de O₂ con la temperatura")+
  theme_minimal(base_size=14)
```


---

# Ambientes de agua dulce (conceptos)

.box[
- Zonas **litorales**, **profundales**, **limnéticas** (lagos)
- **Órdenes de corriente** (Strahler), caudal y granulometría
- **Conectividad río–llanura de inundación** (pulso de inundación)
]

---

# Ríos · Estructura longitudinal y gradientes


.small[
- **Continuum fluvial**: de cabeceras sombreadas (P<sub>alóctono</sub> alto, canales estrechos) → tramos medios (producción autóctona ↑) → grandes ríos (transporte y sedimentación).
- **Pendiente ↓, caudal ↑, tamaño de grano ↓** aguas abajo; diversidad de hábitats **rápidos–remansos–pozas**.
- **Órdenes de corriente** (Strahler) y confluencias: el orden aumenta cuando confluyen dos de igual orden.
]


```{r rios-orden, fig.height=4, echo=FALSE}
# Esquema simple de red de drenaje con órdenes (ilustrativo)
par(mar=c(1,1,1,1)); plot(0,0, type="n", xlim=c(0,10), ylim=c(0,6), axes=FALSE)
segments(1,1, 3,2, lwd=2); text(1,1, "1")
segments(1,2.5, 3,3.2, lwd=2); text(1,2.5, "1")
segments(3,2, 5,2.6, lwd=3); text(3.2,2.1, "2")
segments(3,3.2, 5,2.6, lwd=3)
segments(5,2.6, 8,3.8, lwd=5); text(5.5,2.8, "3")
segments(2,4.5, 5,3.6, lwd=2); text(2,4.5, "1")
segments(4,5.2, 5,3.6, lwd=2); text(4,5.2, "1")
segments(5,3.6, 8,3.8, lwd=3); text(5.5,3.7, "2")
text(5,5.7, "Esquema de órdenes de corriente (Strahler)")
```


---


# Ríos · Hidrograma y pulso de inundación


.small[
- **Hidrogramas** tropicales: fuerte estacionalidad (temporada húmeda/seca).
- **Pulso de inundación**: controla productividad, conectividad lateral y ciclos de vida.
]


```{r hidro, echo=FALSE}
library(ggplot2)
set.seed(1)
mes <- 1:12
P <- c(40, 35, 50, 90, 180, 220, 190, 170, 120, 80, 60, 45)
Q <- pmax(0, stats::filter(P, rep(1/2,2), sides=1) + rnorm(12, 0, 10))
Q <- as.numeric(Q)
df <- data.frame(mes, Q)


ggplot(df, aes(mes, Q)) + geom_area(alpha=.5) + geom_line() +
scale_x_continuous(breaks=1:12) + labs(x="Mes", y="Caudal (u.)",
title="Hidrograma mensual idealizado (clima tropical)") + theme_minimal(base_size=14)
```

---

# Ambiente terrestre · Constricciones físicas

.box[
- **Balance hídrico**: P, ETo, déficit hídrico → estrés
- **Temperatura**: límites fisiológicos; estrategias de termorregulación
- **Viento**: transpiración, carga mecánica, dispersión
]


---

# Ambiente terrestre · Luz en el dosel (Beer-Lambert)

```{r canopy}
LAI <- seq(0, 8, by=0.1)
k <- 0.5
I <- exp(-k*LAI)

ggplot(data.frame(LAI,I), aes(LAI,I))+
  geom_line(size=1)+
  labs(x="Índice de Área Foliar (LAI)", y="I/I0", title="Transmisión de luz a través del dosel (k=0.5)")+
  theme_minimal(base_size=14)
```


---

# Ambiente terrestre · Suelo: esquema de horizontes

```{r soil, fig.height=4.5}
par(mar=c(1,4,1,4))
plot(0,0, type="n", xlim=c(0,1.2), ylim=c(0,1), axes=FALSE, xlab="", ylab="")
# Perfil
rect(0.2,0.82,0.8,0.95, col="#4d3b2f"); text(0.5,0.885, "O", col="white")
rect(0.2,0.62,0.8,0.82, col="#7b5e3b"); text(0.5,0.72, "A", col="white")
rect(0.2,0.48,0.8,0.62, col="#c9c2b8"); text(0.5,0.55, "E")
rect(0.2,0.22,0.8,0.48, col="#9b6b43"); text(0.5,0.35, "B", col="white")
rect(0.2,0.10,0.8,0.22, col="#bba27a"); text(0.5,0.16, "C")
rect(0.2,0.02,0.8,0.10, col="#8f8f8f"); text(0.5,0.06, "R", col="white")
text(0.5,0.98, "Horizontes del suelo (esquema)")
# Leyenda
text(0.85,0.90, "O: orgánico (hojarasca)", adj=0, cex=.8)
text(0.85,0.76, "A: mineral con humus", adj=0, cex=.8)
text(0.85,0.58, "E: eluviación (lixiviado)", adj=0, cex=.8)
text(0.85,0.36, "B: iluviación (acumulación)", adj=0, cex=.8)
text(0.85,0.18, "C: material parental", adj=0, cex=.8)
text(0.85,0.06, "R: roca madre", adj=0, cex=.8)
```


---

# Actividades reproducibles (demostraciones para aula)

.box[
1) **Clasificación climática, aridez, balance hídrico** con los datos de ejemplo del paquete `ClimClass`, y discutir que implicaciones tendría para la distribución de los seres vivos, especialmente de las plantas.  
2) Perfiles de luz en agua para **k = 0.05, 0.15, 0.5**, discutir implicaciones para productores primarios.
3) **Déficit hídrico** mensual (P − ETo) con datos de estaciones cercanas (FAO-56) y clasificar el bioma esperado.
]

---

# Referencias sugeridas

.small[
- Lomolino, Riddle, Whittaker & Brown. *Biogeography*. Sinauer (eds.). Cap. 3. Plantilla geográfica. Visualización y análisis en biogeografía.
- Smith & Smith. *Ecología* (6ª ed.). Pearson. Cap. 3–5. Clima. Ambiente acuático. Ambiente terrestre.
]


---

class: center, middle

# Fin · ¡Gracias!
